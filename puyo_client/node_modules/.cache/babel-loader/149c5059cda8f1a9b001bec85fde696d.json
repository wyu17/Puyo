{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"/home/wyu/Desktop/puyo/puyo/src/components/Puyo.js\",\n    _s = $RefreshSig$();\n\nimport React from 'react';\nimport { createStage, STAGE_HEIGHT, STAGE_WIDTH } from '../gameHelpers';\nimport Stage from './Stage';\nimport Display from './Display';\nimport Button from './Button';\nimport { useState } from 'react';\nimport { useCurrentBlock } from '../hooks/useCurrentBlock';\nimport { useStage } from '../hooks/useStage';\nimport { randomBlock } from '../block';\nimport \"./Puyo.css\";\n\nconst Puyo = () => {\n  _s();\n\n  // GameOver is initially false\n  const [gameOver, setGameOver] = useState(false);\n  const [currentBlock, setCurBlock, updateCurPos, resetCurPos, rotateCurBlock] = useCurrentBlock();\n  const [stage, setStage, resetStage, updateStage, registerCollision] = useStage(currentBlock);\n  console.log(\"rerender\");\n\n  const checkBoundaries = (currentBlock, xdir, ydir) => {\n    let xPos = currentBlock.position.x;\n    let yPos = currentBlock.position.y; // STAGE_HEIGHT - 2 because 0 based indexing on coordinates, and position counts the top block so must end one earlier\n\n    if (xPos === 0 && xdir === -1 || xPos === STAGE_WIDTH - 1 && xdir === 1 || yPos === STAGE_HEIGHT - 2 && ydir === 1) {\n      return false;\n    } else {\n      return true;\n    }\n  };\n\n  const checkRotationBoundaries = currentBlock => {\n    let xPos = currentBlock.position.x;\n    let yPos = currentBlock.position.y;\n    let dir = currentBlock.dir; // Prevents rotation from upright to right on the right edge, rotating down on the bottom and rotating to the left on the left edge\n\n    if (dir === 0 && xPos === STAGE_WIDTH - 1 || dir === 1 && yPos === STAGE_HEIGHT - 1 || dir === 2 && xPos === 0) {\n      return false;\n    } else {\n      return true;\n    }\n  };\n\n  const checkCollision = (block, stage) => {\n    console.log(block.position2.y);\n\n    if (block.position2.y === STAGE_HEIGHT - 1 || stage[block.position2.y + 1][block.position2.x].props.type != \"EMPTY\" || (block.dir === 1 || block.dir === 3) && stage[block.position.y + 1][block.position.x].props.type != \"EMPTY\") {\n      return true;\n    } else {\n      return false;\n    }\n  };\n\n  const handleCollision = (block, stage) => {\n    console.log(\"collision!\");\n    let upperColor = randomBlock().color;\n    let lowerColor = randomBlock().color;\n    let newStage = registerCollision(block, stage, upperColor, lowerColor);\n    setStage(newStage);\n    let newBlock = resetCurPos(upperColor, lowerColor);\n    setCurBlock(newBlock);\n  };\n\n  const rotateBlock = (prevPosition, prevPosition2) => {\n    if (checkRotationBoundaries(currentBlock)) {\n      let block = rotateCurBlock(currentBlock);\n      let newStage = updateStage(block, stage, prevPosition, prevPosition2);\n      setStage(newStage);\n\n      if (checkCollision(block, newStage)) {\n        handleCollision(block, newStage);\n      } else {\n        setCurBlock(block);\n      }\n    }\n  };\n\n  const moveBlock = (xdir, ydir, prevPosition, prevPosition2, rotate) => {\n    let block;\n\n    if (checkBoundaries(currentBlock, xdir, ydir) && !rotate) {\n      block = updateCurPos(currentBlock, xdir, ydir);\n    } else if (checkRotationBoundaries(currentBlock) && rotate) {\n      block = rotateCurBlock(currentBlock);\n    } else {\n      return;\n    }\n\n    let curStage = updateStage(block, stage, prevPosition, prevPosition2);\n    setStage(curStage);\n\n    if (checkCollision(block, curStage)) {\n      handleCollision(block, curStage);\n    } else {\n      setCurBlock(block);\n    }\n  };\n\n  const startGame = () => {\n    // Providing the colours in this file maintains colour state across the current block and the stage\n    let upperColor = randomBlock().color;\n    let lowerColor = randomBlock().color;\n    setCurBlock(resetCurPos(upperColor, lowerColor));\n    setStage(resetStage(upperColor, lowerColor));\n  };\n\n  const move = ({\n    keyCode\n  }) => {\n    if (!gameOver) {\n      // Copy by value to preserve previous position\n      let prevPosition = Object.assign({}, currentBlock.position);\n      let prevPosition2 = Object.assign({}, currentBlock.position2);\n\n      if (keyCode === 37) {\n        moveBlock(-1, 0, prevPosition, prevPosition2, false);\n      } else if (keyCode === 39) {\n        moveBlock(1, 0, prevPosition, prevPosition2, false);\n      } else if (keyCode === 40) {\n        moveBlock(0, 1, prevPosition, prevPosition2, false);\n      } else if (keyCode === 38) {\n        moveBlock(0, 0, prevPosition, prevPosition2, true);\n      }\n    }\n  }; // Different screen for game over\n\n\n  if (!gameOver) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"puyo\",\n      tabIndex: \"0\",\n      onKeyDown: e => move(e),\n      children: [/*#__PURE__*/_jsxDEV(\"aside\", {\n        children: [/*#__PURE__*/_jsxDEV(Display, {\n          text: \"Score\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 128,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"startButton\",\n          children: /*#__PURE__*/_jsxDEV(Button, {\n            callBack: startGame,\n            text: \"New Game\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 130,\n            columnNumber: 11\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 129,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(Stage, {\n        stage: stage\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 133,\n        columnNumber: 7\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 5\n    }, this);\n  } else {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \" Game Over! Do you want to play again? \"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 139,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"startButton\",\n        children: /*#__PURE__*/_jsxDEV(Button, {\n          callBack: startGame,\n          text: \"New Game\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 141,\n          columnNumber: 7\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 140,\n        columnNumber: 7\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 7\n    }, this);\n  }\n};\n\n_s(Puyo, \"oYlFx1+RVNF5b7uw1RcxHFPD1r0=\", false, function () {\n  return [useCurrentBlock, useStage];\n});\n\n_c = Puyo;\nexport default Puyo;\n\nvar _c;\n\n$RefreshReg$(_c, \"Puyo\");","map":{"version":3,"sources":["/home/wyu/Desktop/puyo/puyo/src/components/Puyo.js"],"names":["React","createStage","STAGE_HEIGHT","STAGE_WIDTH","Stage","Display","Button","useState","useCurrentBlock","useStage","randomBlock","Puyo","gameOver","setGameOver","currentBlock","setCurBlock","updateCurPos","resetCurPos","rotateCurBlock","stage","setStage","resetStage","updateStage","registerCollision","console","log","checkBoundaries","xdir","ydir","xPos","position","x","yPos","y","checkRotationBoundaries","dir","checkCollision","block","position2","props","type","handleCollision","upperColor","color","lowerColor","newStage","newBlock","rotateBlock","prevPosition","prevPosition2","moveBlock","rotate","curStage","startGame","move","keyCode","Object","assign","e"],"mappings":"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","sourcesContent":["import React from 'react';\n\nimport { createStage , STAGE_HEIGHT, STAGE_WIDTH } from '../gameHelpers';\nimport Stage from './Stage';\nimport Display from './Display';\nimport Button from './Button';\n\nimport { useState } from 'react';\nimport { useCurrentBlock } from '../hooks/useCurrentBlock';\nimport { useStage } from '../hooks/useStage';\nimport { randomBlock } from '../block';\n\nimport \"./Puyo.css\";\n\n\nconst Puyo = () => {\n  // GameOver is initially false\n  const [gameOver, setGameOver] = useState(false);\n  const [currentBlock, setCurBlock, updateCurPos, resetCurPos, rotateCurBlock] = useCurrentBlock();\n  const [stage, setStage, resetStage, updateStage, registerCollision] = useStage(currentBlock);\n\n  console.log(\"rerender\");\n\n  const checkBoundaries = (currentBlock, xdir, ydir) => {\n    let xPos = currentBlock.position.x;\n    let yPos = currentBlock.position.y;\n    // STAGE_HEIGHT - 2 because 0 based indexing on coordinates, and position counts the top block so must end one earlier\n    if ((xPos === 0 && xdir === -1) || (xPos === STAGE_WIDTH - 1 && xdir === 1) || (yPos === STAGE_HEIGHT - 2 && ydir === 1)) {\n      return false;\n    } else {\n      return true;\n    }\n  }\n\n  const checkRotationBoundaries = (currentBlock) => {\n    let xPos = currentBlock.position.x;\n    let yPos = currentBlock.position.y;\n    let dir = currentBlock.dir;\n    // Prevents rotation from upright to right on the right edge, rotating down on the bottom and rotating to the left on the left edge\n    if ((dir === 0 && xPos === STAGE_WIDTH - 1) || (dir === 1 && yPos === STAGE_HEIGHT - 1) || (dir === 2 && xPos === 0)) {\n      return false;\n    } else {\n      return true;\n    }\n  } \n\n  const checkCollision = (block, stage) => {\n    console.log(block.position2.y);\n    if ((block.position2.y === STAGE_HEIGHT - 1) || (stage[block.position2.y + 1][block.position2.x].props.type != \"EMPTY\") || \n    ((block.dir === 1 || block.dir === 3) && stage[block.position.y + 1][block.position.x].props.type != \"EMPTY\")) {\n      return true;\n    } else {\n      return false;\n    }\n  }\n\n  const handleCollision = (block, stage) => {\n    console.log(\"collision!\");\n    let upperColor = randomBlock().color;\n    let lowerColor = randomBlock().color;\n    let newStage = registerCollision(block, stage, upperColor, lowerColor);\n    setStage(newStage);\n    let newBlock = resetCurPos(upperColor, lowerColor)\n    setCurBlock(newBlock);\n  }\n\n  const rotateBlock = (prevPosition, prevPosition2) => {\n    if (checkRotationBoundaries(currentBlock)){\n      let block = rotateCurBlock(currentBlock);\n      let newStage = updateStage(block, stage, prevPosition, prevPosition2);\n      setStage(newStage);\n      if (checkCollision(block, newStage)) {\n        handleCollision(block, newStage);\n      } else {\n        setCurBlock(block);\n    }\n    }\n  }\n\n  const moveBlock = (xdir, ydir, prevPosition, prevPosition2, rotate) => {\n    let block;\n    if (checkBoundaries(currentBlock, xdir, ydir) && !rotate) { \n      block = updateCurPos(currentBlock, xdir, ydir);\n    } else if (checkRotationBoundaries(currentBlock) && rotate) {\n      block = rotateCurBlock(currentBlock); \n    } else {\n      return;\n    }\n    let curStage = updateStage(block, stage, prevPosition, prevPosition2)\n    setStage(curStage);\n    if (checkCollision(block, curStage)) {\n      handleCollision(block, curStage);\n    } else {\n      setCurBlock(block);\n    }\n  }\n  \n  const startGame = () => {\n    // Providing the colours in this file maintains colour state across the current block and the stage\n    let upperColor = randomBlock().color;\n    let lowerColor = randomBlock().color;\n    setCurBlock(resetCurPos(upperColor, lowerColor));\n    setStage(resetStage(upperColor, lowerColor));\n  }\n  \n  const move = ({ keyCode }) => {\n    if (!gameOver) {\n      // Copy by value to preserve previous position\n      let prevPosition = Object.assign({}, currentBlock.position);\n      let prevPosition2 = Object.assign({}, currentBlock.position2);\n      if (keyCode === 37) {\n          moveBlock(-1, 0, prevPosition, prevPosition2, false);\n      } else if (keyCode === 39) {\n          moveBlock(1, 0, prevPosition, prevPosition2, false);\n      } else if (keyCode === 40) {\n          moveBlock(0, 1, prevPosition, prevPosition2, false)\n      } else if (keyCode === 38) {\n         moveBlock(0, 0, prevPosition, prevPosition2, true);\n      }\n    }\n  }\n\n  // Different screen for game over\n  if (!gameOver) {\n  return (\n    <div className = 'puyo' tabIndex = \"0\" onKeyDown={e => move(e)}>\n      <aside>\n        <Display text=\"Score\" />\n        <div className = \"startButton\">\n          <Button callBack = { startGame } text = \"New Game\"/>\n        </div>\n      </aside>\n      <Stage stage = { stage } />\n    </div>\n  )\n  } else {\n    return (\n      <div>\n      <h2> Game Over! Do you want to play again? </h2>\n      <div className = \"startButton\">\n      <Button callBack = { startGame } text = \"New Game\"/>\n      </div>\n      </div>\n    )\n  }\n};\n\nexport default Puyo;\n"]},"metadata":{},"sourceType":"module"}